{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///home/abhi/Documents/kmc/SIH/civic-cops-frontend/src/app/components/IssueCard.tsx"],"sourcesContent":["\"use client\"\n\ninterface IssueCardProps {\n  id: string\n  date: string\n  status: string\n  image: string\n  onClick?: () => void\n}\n\nexport function IssueCard({ id, date, status, image, onClick }: IssueCardProps) {\n  return (\n    <div \n      className=\"flex items-stretch bg-white rounded-xl px-0 py-0 shadow-md border border-gray-100 cursor-pointer hover:shadow-lg hover:bg-gray-50 transition-all duration-200\"\n      onClick={onClick}\n    >\n      <div className=\"flex-shrink-0\">\n        <img\n          src={image || \"data:image/gif;base64,R0lGODlhAQABAAAAACw=\"}\n          alt=\"Issue\"\n          loading=\"lazy\"\n          onError={(e) => { (e.currentTarget as HTMLImageElement).src = \"data:image/gif;base64,R0lGODlhAQABAAAAACw=\" }}\n          className=\"rounded-tl-xl rounded-bl-xl rounded-r-none object-cover bg-gray-200 border border-gray-300 h-full w-[110px]\"\n          style={{ width: 110, height: 110 }}\n        />\n      </div>\n      <div className=\"text-base flex flex-col gap-1 justify-center ml-8\">\n        <div className=\"flex gap-2 items-center\">\n          <span className=\"font-semibold text-gray-800\">Issue ID:</span>\n          <span className=\"text-gray-500 font-medium\">{id}</span>\n        </div>\n        <div className=\"flex gap-2 items-center\">\n          <span className=\"font-semibold text-gray-800\">Date:</span>\n          <span className=\"text-gray-500 font-medium\">{date}</span>\n        </div>\n        <div className=\"flex gap-2 items-center\">\n          <span className=\"font-semibold text-blue-700\">Status:</span>\n          <span className=\"text-gray-500 font-medium\">{status}</span>\n        </div>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;AAAA;;AAUO,SAAS,UAAU,EAAE,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,OAAO,EAAkB;IAC5E,qBACE,2QAAC;QACC,WAAU;QACV,SAAS;;0BAET,2QAAC;gBAAI,WAAU;0BACb,cAAA,2QAAC;oBACC,KAAK,SAAS;oBACd,KAAI;oBACJ,SAAQ;oBACR,SAAS,CAAC;wBAAS,EAAE,aAAa,CAAsB,GAAG,GAAG;oBAA6C;oBAC3G,WAAU;oBACV,OAAO;wBAAE,OAAO;wBAAK,QAAQ;oBAAI;;;;;;;;;;;0BAGrC,2QAAC;gBAAI,WAAU;;kCACb,2QAAC;wBAAI,WAAU;;0CACb,2QAAC;gCAAK,WAAU;0CAA8B;;;;;;0CAC9C,2QAAC;gCAAK,WAAU;0CAA6B;;;;;;;;;;;;kCAE/C,2QAAC;wBAAI,WAAU;;0CACb,2QAAC;gCAAK,WAAU;0CAA8B;;;;;;0CAC9C,2QAAC;gCAAK,WAAU;0CAA6B;;;;;;;;;;;;kCAE/C,2QAAC;wBAAI,WAAU;;0CACb,2QAAC;gCAAK,WAAU;0CAA8B;;;;;;0CAC9C,2QAAC;gCAAK,WAAU;0CAA6B;;;;;;;;;;;;;;;;;;;;;;;;AAKvD","debugId":null}},
    {"offset": {"line": 159, "column": 0}, "map": {"version":3,"sources":["file:///home/abhi/Documents/kmc/SIH/civic-cops-frontend/src/app/components/BottomNavBar.tsx"],"sourcesContent":["\"use client\"\n\nimport { Home, Camera, User, Search } from \"lucide-react\"\nimport Link from \"next/link\"\n\nexport function BottomNavbar() {\n  return (\n    <div className=\"fixed bottom-0 left-0 right-0 bg-white border-t flex justify-around items-center h-16 shadow-lg\">\n      {/* Home */}\n      <Link href=\"/\" className=\"flex flex-col items-center text-gray-600\">\n        <Home size={24} />\n        <span className=\"text-xs\">Home</span>\n      </Link>\n\n      {/* Track Issues */}\n      <Link href=\"/track_issue\" className=\"flex flex-col items-center text-gray-600\">\n        <Search size={24} />\n        <span className=\"text-xs\">Track</span>\n      </Link>\n\n      {/* Report (big button) */}\n      <Link\n        href=\"/report\"\n        className=\"flex flex-col items-center -mt-8 bg-blue-500 rounded-full w-16 h-16 justify-center text-white shadow-lg\"\n      >\n        <Camera size={28} />\n      </Link>\n\n      {/* Profile */}\n      <Link href=\"/profile\" className=\"flex flex-col items-center text-gray-600\">\n        <User size={24} />\n        <span className=\"text-xs\">Profile</span>\n      </Link>\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AAAA;AAAA;AAAA;AACA;AAHA;;;;AAKO,SAAS;IACd,qBACE,2QAAC;QAAI,WAAU;;0BAEb,2QAAC,oMAAI;gBAAC,MAAK;gBAAI,WAAU;;kCACvB,2QAAC,wOAAI;wBAAC,MAAM;;;;;;kCACZ,2QAAC;wBAAK,WAAU;kCAAU;;;;;;;;;;;;0BAI5B,2QAAC,oMAAI;gBAAC,MAAK;gBAAe,WAAU;;kCAClC,2QAAC,6OAAM;wBAAC,MAAM;;;;;;kCACd,2QAAC;wBAAK,WAAU;kCAAU;;;;;;;;;;;;0BAI5B,2QAAC,oMAAI;gBACH,MAAK;gBACL,WAAU;0BAEV,cAAA,2QAAC,6OAAM;oBAAC,MAAM;;;;;;;;;;;0BAIhB,2QAAC,oMAAI;gBAAC,MAAK;gBAAW,WAAU;;kCAC9B,2QAAC,uOAAI;wBAAC,MAAM;;;;;;kCACZ,2QAAC;wBAAK,WAAU;kCAAU;;;;;;;;;;;;;;;;;;AAIlC","debugId":null}},
    {"offset": {"line": 278, "column": 0}, "map": {"version":3,"sources":["file:///home/abhi/Documents/kmc/SIH/civic-cops-frontend/src/app/components/AnalyticsCard.tsx"],"sourcesContent":["\"use client\"\n\nimport React from \"react\"\nimport { LucideIcon } from \"lucide-react\"\n\ninterface AnalyticsCardProps {\n  title: string\n  value: number\n  icon: LucideIcon\n  color: string\n  bgColor: string\n  iconColor: string\n}\n\nexport function AnalyticsCard({ title, value, icon: Icon, color, bgColor, iconColor }: AnalyticsCardProps) {\n  return (\n    <div className={`${bgColor} rounded-xl p-4 shadow-sm border border-gray-100`}>\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex-1\">\n          <p className=\"text-sm font-medium text-gray-600 mb-1\">{title}</p>\n          <p className={`text-2xl font-bold ${color}`}>{value}</p>\n        </div>\n        <div className={`${iconColor} p-3 rounded-lg`}>\n          <Icon size={24} />\n        </div>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;AAAA;;AAcO,SAAS,cAAc,EAAE,KAAK,EAAE,KAAK,EAAE,MAAM,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE,SAAS,EAAsB;IACvG,qBACE,2QAAC;QAAI,WAAW,GAAG,QAAQ,gDAAgD,CAAC;kBAC1E,cAAA,2QAAC;YAAI,WAAU;;8BACb,2QAAC;oBAAI,WAAU;;sCACb,2QAAC;4BAAE,WAAU;sCAA0C;;;;;;sCACvD,2QAAC;4BAAE,WAAW,CAAC,mBAAmB,EAAE,OAAO;sCAAG;;;;;;;;;;;;8BAEhD,2QAAC;oBAAI,WAAW,GAAG,UAAU,eAAe,CAAC;8BAC3C,cAAA,2QAAC;wBAAK,MAAM;;;;;;;;;;;;;;;;;;;;;;AAKtB","debugId":null}},
    {"offset": {"line": 346, "column": 0}, "map": {"version":3,"sources":["file:///home/abhi/Documents/kmc/SIH/civic-cops-frontend/src/app/components/AnalyticsSection.tsx"],"sourcesContent":["\"use client\"\n\nimport React from \"react\"\nimport { FileText, Clock, CheckCircle, XCircle, AlertCircle } from \"lucide-react\"\nimport { AnalyticsCard } from \"./AnalyticsCard\"\nimport { UserStatsResponse } from \"@/lib/api\"\n\ninterface AnalyticsSectionProps {\n  stats: UserStatsResponse\n  loading?: boolean\n  lastUpdatedText?: string\n  errorText?: string\n}\n\nexport function AnalyticsSection({ stats, loading = false, lastUpdatedText, errorText }: AnalyticsSectionProps) {\n  if (loading) {\n    return (\n      <div className=\"mb-8\">\n        <div className=\"flex items-center justify-between mb-2\">\n          <h2 className=\"text-lg font-semibold text-gray-800\">Complaint Analytics</h2>\n          <span className=\"text-xs text-gray-500\">Loadingâ€¦</span>\n        </div>\n        <div className=\"grid grid-cols-2 gap-4\">\n          {[...Array(4)].map((_, i) => (\n            <div key={i} className=\"bg-gray-100 rounded-xl p-4 animate-pulse\">\n              <div className=\"h-4 bg-gray-200 rounded mb-2\"></div>\n              <div className=\"h-6 bg-gray-200 rounded w-1/2\"></div>\n            </div>\n          ))}\n        </div>\n      </div>\n    )\n  }\n\n  const analyticsData = [\n    {\n      title: \"Total Complaints\",\n      value: stats.total_issues,\n      icon: FileText,\n      color: \"text-blue-600\",\n      bgColor: \"bg-blue-50\",\n      iconColor: \"bg-blue-100 text-blue-600\"\n    },\n    {\n      title: \"Pending\",\n      value: stats.by_status.pending,\n      icon: Clock,\n      color: \"text-orange-600\",\n      bgColor: \"bg-orange-50\",\n      iconColor: \"bg-orange-100 text-orange-600\"\n    },\n    {\n      title: \"In Progress\",\n      value: stats.by_status.in_progress,\n      icon: AlertCircle,\n      color: \"text-yellow-600\",\n      bgColor: \"bg-yellow-50\",\n      iconColor: \"bg-yellow-100 text-yellow-600\"\n    },\n    {\n      title: \"Resolved\",\n      value: stats.by_status.resolved,\n      icon: CheckCircle,\n      color: \"text-green-600\",\n      bgColor: \"bg-green-50\",\n      iconColor: \"bg-green-100 text-green-600\"\n    }\n  ]\n\n  return (\n    <div className=\"mb-8\">\n      <div className=\"flex items-center justify-between mb-2\">\n        <h2 className=\"text-lg font-semibold text-gray-800\">Complaint Analytics</h2>\n        <div className=\"flex items-center gap-3\">\n          {errorText && (\n            <span className=\"text-xs text-red-600\">{errorText}</span>\n          )}\n          {lastUpdatedText && (\n            <span className=\"text-xs text-gray-500\">Updated {lastUpdatedText}</span>\n          )}\n        </div>\n      </div>\n      <div className=\"grid grid-cols-2 gap-4\">\n        {analyticsData.map((data, index) => (\n          <AnalyticsCard\n            key={index}\n            title={data.title}\n            value={data.value}\n            icon={data.icon}\n            color={data.color}\n            bgColor={data.bgColor}\n            iconColor={data.iconColor}\n          />\n        ))}\n      </div>\n      \n      {/* Additional stats row */}\n      <div className=\"mt-4 grid grid-cols-1 gap-4\">\n        <div className=\"bg-gray-50 rounded-xl p-4 border border-gray-100\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center space-x-3\">\n              <div className=\"bg-red-100 text-red-600 p-2 rounded-lg\">\n                <XCircle size={20} />\n              </div>\n              <div>\n                <p className=\"text-sm font-medium text-gray-600\">Rejected</p>\n                <p className=\"text-xl font-bold text-red-600\">{stats.by_status.rejected}</p>\n              </div>\n            </div>\n            <div className=\"text-right\">\n              <p className=\"text-xs text-gray-500\">Resolution Rate</p>\n              <p className=\"text-sm font-semibold text-gray-700\">\n                {stats.total_issues > 0 \n                  ? Math.round((stats.by_status.resolved / stats.total_issues) * 100)\n                  : 0}%\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;AAGA;AAAA;AAAA;AAAA;AAAA;AACA;AAJA;;;;AAcO,SAAS,iBAAiB,EAAE,KAAK,EAAE,UAAU,KAAK,EAAE,eAAe,EAAE,SAAS,EAAyB;IAC5G,IAAI,SAAS;QACX,qBACE,2QAAC;YAAI,WAAU;;8BACb,2QAAC;oBAAI,WAAU;;sCACb,2QAAC;4BAAG,WAAU;sCAAsC;;;;;;sCACpD,2QAAC;4BAAK,WAAU;sCAAwB;;;;;;;;;;;;8BAE1C,2QAAC;oBAAI,WAAU;8BACZ;2BAAI,MAAM;qBAAG,CAAC,GAAG,CAAC,CAAC,GAAG,kBACrB,2QAAC;4BAAY,WAAU;;8CACrB,2QAAC;oCAAI,WAAU;;;;;;8CACf,2QAAC;oCAAI,WAAU;;;;;;;2BAFP;;;;;;;;;;;;;;;;IAQpB;IAEA,MAAM,gBAAgB;QACpB;YACE,OAAO;YACP,OAAO,MAAM,YAAY;YACzB,MAAM,uPAAQ;YACd,OAAO;YACP,SAAS;YACT,WAAW;QACb;QACA;YACE,OAAO;YACP,OAAO,MAAM,SAAS,CAAC,OAAO;YAC9B,MAAM,0OAAK;YACX,OAAO;YACP,SAAS;YACT,WAAW;QACb;QACA;YACE,OAAO;YACP,OAAO,MAAM,SAAS,CAAC,WAAW;YAClC,MAAM,gQAAW;YACjB,OAAO;YACP,SAAS;YACT,WAAW;QACb;QACA;YACE,OAAO;YACP,OAAO,MAAM,SAAS,CAAC,QAAQ;YAC/B,MAAM,uQAAW;YACjB,OAAO;YACP,SAAS;YACT,WAAW;QACb;KACD;IAED,qBACE,2QAAC;QAAI,WAAU;;0BACb,2QAAC;gBAAI,WAAU;;kCACb,2QAAC;wBAAG,WAAU;kCAAsC;;;;;;kCACpD,2QAAC;wBAAI,WAAU;;4BACZ,2BACC,2QAAC;gCAAK,WAAU;0CAAwB;;;;;;4BAEzC,iCACC,2QAAC;gCAAK,WAAU;;oCAAwB;oCAAS;;;;;;;;;;;;;;;;;;;0BAIvD,2QAAC;gBAAI,WAAU;0BACZ,cAAc,GAAG,CAAC,CAAC,MAAM,sBACxB,2QAAC,wLAAa;wBAEZ,OAAO,KAAK,KAAK;wBACjB,OAAO,KAAK,KAAK;wBACjB,MAAM,KAAK,IAAI;wBACf,OAAO,KAAK,KAAK;wBACjB,SAAS,KAAK,OAAO;wBACrB,WAAW,KAAK,SAAS;uBANpB;;;;;;;;;;0BAYX,2QAAC;gBAAI,WAAU;0BACb,cAAA,2QAAC;oBAAI,WAAU;8BACb,cAAA,2QAAC;wBAAI,WAAU;;0CACb,2QAAC;gCAAI,WAAU;;kDACb,2QAAC;wCAAI,WAAU;kDACb,cAAA,2QAAC,oPAAO;4CAAC,MAAM;;;;;;;;;;;kDAEjB,2QAAC;;0DACC,2QAAC;gDAAE,WAAU;0DAAoC;;;;;;0DACjD,2QAAC;gDAAE,WAAU;0DAAkC,MAAM,SAAS,CAAC,QAAQ;;;;;;;;;;;;;;;;;;0CAG3E,2QAAC;gCAAI,WAAU;;kDACb,2QAAC;wCAAE,WAAU;kDAAwB;;;;;;kDACrC,2QAAC;wCAAE,WAAU;;4CACV,MAAM,YAAY,GAAG,IAClB,KAAK,KAAK,CAAC,AAAC,MAAM,SAAS,CAAC,QAAQ,GAAG,MAAM,YAAY,GAAI,OAC7D;4CAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQtB","debugId":null}},
    {"offset": {"line": 640, "column": 0}, "map": {"version":3,"sources":["file:///home/abhi/Documents/kmc/SIH/civic-cops-frontend/src/lib/api.ts"],"sourcesContent":["\"use client\"\n\nconst API_BASE_URL = process.env.NEXT_PUBLIC_API_BASE_URL || \"https://civic-ops.onrender.com\";\n\nfunction getStoredToken(): string | null {\n  if (typeof window === \"undefined\") return null;\n  // Support both keys used elsewhere in the app\n  return localStorage.getItem(\"access_token\") || localStorage.getItem(\"token\");\n}\n\nexport async function apiFetch(path: string, options: RequestInit = {}) {\n  const url = `${API_BASE_URL}${path}`;\n  const token = getStoredToken();\n\n  const headers = new Headers(options.headers || {});\n  if (!headers.has(\"Content-Type\") && !(options.body instanceof FormData)) {\n    headers.set(\"Content-Type\", \"application/json\");\n  }\n  if (token) {\n    headers.set(\"Authorization\", `Bearer ${token}`);\n  }\n\n  const response = await fetch(url, { ...options, headers });\n  const contentType = response.headers.get(\"content-type\") || \"\";\n  const isJson = contentType.includes(\"application/json\");\n  const data = isJson ? await response.json() : await response.text();\n\n  if (!response.ok) {\n    const message = (isJson && (data?.detail || data?.message)) || response.statusText;\n    throw new Error(message || \"Request failed\");\n  }\n\n  return data;\n}\n\nexport type IssueResponse = {\n  issue_id: number;\n  title: string;\n  description: string;\n  category: string;\n  location?: string | null;\n  latitude?: number | null;\n  longitude?: number | null;\n  photo_url?: string | null;\n  voice_note_url?: string | null;\n  status: \"pending\" | \"in_progress\" | \"resolved\" | \"rejected\";\n  priority: \"unassigned\" | \"low\" | \"medium\" | \"high\" | \"urgent\";\n  created_at: string;\n  updated_at: string;\n};\n\nexport async function getIssueById(issueId: string | number): Promise<IssueResponse> {\n  return apiFetch(`/users/issues/${issueId}`, { method: \"GET\" });\n}\n\nexport interface UserStatsResponse {\n  total_issues: number\n  by_status: {\n    pending: number\n    in_progress: number\n    resolved: number\n    rejected: number\n  }\n}\n\nexport async function getUserStats(): Promise<UserStatsResponse> {\n  return apiFetch(\"/users/my-issues/stats\", { method: \"GET\" });\n}\n\n\n"],"names":[],"mappings":";;;;;;;;AAAA;AAEA,MAAM,eAAe,QAAQ,GAAG,CAAC,wBAAwB,IAAI;AAE7D,SAAS;IACP,wCAAmC,OAAO;;;AAG5C;AAEO,eAAe,SAAS,IAAY,EAAE,UAAuB,CAAC,CAAC;IACpE,MAAM,MAAM,GAAG,eAAe,MAAM;IACpC,MAAM,QAAQ;IAEd,MAAM,UAAU,IAAI,QAAQ,QAAQ,OAAO,IAAI,CAAC;IAChD,IAAI,CAAC,QAAQ,GAAG,CAAC,mBAAmB,CAAC,CAAC,QAAQ,IAAI,YAAY,QAAQ,GAAG;QACvE,QAAQ,GAAG,CAAC,gBAAgB;IAC9B;IACA,IAAI,OAAO;QACT,QAAQ,GAAG,CAAC,iBAAiB,CAAC,OAAO,EAAE,OAAO;IAChD;IAEA,MAAM,WAAW,MAAM,MAAM,KAAK;QAAE,GAAG,OAAO;QAAE;IAAQ;IACxD,MAAM,cAAc,SAAS,OAAO,CAAC,GAAG,CAAC,mBAAmB;IAC5D,MAAM,SAAS,YAAY,QAAQ,CAAC;IACpC,MAAM,OAAO,SAAS,MAAM,SAAS,IAAI,KAAK,MAAM,SAAS,IAAI;IAEjE,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,UAAU,AAAC,UAAU,CAAC,MAAM,UAAU,MAAM,OAAO,KAAM,SAAS,UAAU;QAClF,MAAM,IAAI,MAAM,WAAW;IAC7B;IAEA,OAAO;AACT;AAkBO,eAAe,aAAa,OAAwB;IACzD,OAAO,SAAS,CAAC,cAAc,EAAE,SAAS,EAAE;QAAE,QAAQ;IAAM;AAC9D;AAYO,eAAe;IACpB,OAAO,SAAS,0BAA0B;QAAE,QAAQ;IAAM;AAC5D","debugId":null}},
    {"offset": {"line": 692, "column": 0}, "map": {"version":3,"sources":["file:///home/abhi/Documents/kmc/SIH/civic-cops-frontend/src/app/home/page.tsx"],"sourcesContent":["\"use client\"\n\nimport React from \"react\"\nimport { useRouter, useSearchParams } from \"next/navigation\"\nimport { IssueCard } from \"../components/IssueCard\"\nimport { BottomNavbar } from \"../components/BottomNavBar\"\nimport { AnalyticsSection } from \"../components/AnalyticsSection\"\nimport { apiFetch, type IssueResponse, type UserStatsResponse } from \"@/lib/api\"\n\nexport default function HomePage() {\n  const router = useRouter()\n  const searchParams = useSearchParams()\n  const [issues, setIssues] = React.useState<IssueResponse[]>([])\n  const [stats, setStats] = React.useState<UserStatsResponse | null>(null)\n  const [loading, setLoading] = React.useState(true)\n  const [statsLoading, setStatsLoading] = React.useState(true)\n  const [error, setError] = React.useState(\"\")\n  const [showSuccess, setShowSuccess] = React.useState(false)\n  const isFetchingRef = React.useRef(false)\n  const [lastUpdated, setLastUpdated] = React.useState<string>(\"\")\n  const [statsError, setStatsError] = React.useState<string>(\"\")\n\n  // Format a Date (or ISO string) to Indian Standard Time (IST)\n  const formatIST = (dateInput: Date | string) => {\n    const d = typeof dateInput === \"string\" ? new Date(dateInput) : dateInput\n    return new Intl.DateTimeFormat(\"en-IN\", {\n      timeZone: \"Asia/Kolkata\",\n      hour: \"2-digit\",\n      minute: \"2-digit\",\n      second: \"2-digit\",\n    }).format(d)\n  }\n\n  // Fetch trusted time for IST (fallback to local clock if network fails)\n  const getTrustedIST = React.useCallback(async (): Promise<string> => {\n    try {\n      const res = await fetch(\"https://worldtimeapi.org/api/timezone/Asia/Kolkata\", { cache: \"no-store\" })\n      if (res.ok) {\n        const data = await res.json()\n        // worldtimeapi returns ISO8601 in data.datetime\n        return formatIST(data.datetime)\n      }\n    } catch {}\n    // Fallback to local time coerced to IST\n    return formatIST(new Date())\n  }, [])\n\n  React.useEffect(() => {\n    // Check for success parameter\n    if (searchParams.get(\"success\") === \"true\") {\n      setShowSuccess(true)\n      // Remove success parameter from URL\n      const newUrl = new URL(window.location.href)\n      newUrl.searchParams.delete(\"success\")\n      window.history.replaceState({}, \"\", newUrl.toString())\n    }\n  }, [searchParams])\n\n  const fetchData = React.useCallback(async () => {\n    if (isFetchingRef.current) return\n    isFetchingRef.current = true\n    try {\n      setStatsLoading(true)\n      setError(\"\")\n      setStatsError(\"\")\n      // Fetch issues and stats in parallel\n      const [issuesData, statsData] = await Promise.allSettled([\n        apiFetch(\"/users/my-issues\", { method: \"GET\" }),\n        apiFetch(\"/users/my-issues/stats\", { method: \"GET\" })\n      ])\n      // Handle issues data\n      if (issuesData.status === \"fulfilled\") {\n        console.log(\"Issues data:\", issuesData.value)\n        setIssues(Array.isArray(issuesData.value) ? issuesData.value : [])\n      } else {\n        console.error(\"Failed to fetch issues:\", issuesData.reason)\n        setIssues([])\n      }\n      // Handle stats data\n      if (statsData.status === \"fulfilled\") {\n        console.log(\"Stats data:\", statsData.value)\n        setStats(statsData.value)\n        setLastUpdated(await getTrustedIST())\n      } else {\n        console.error(\"Failed to fetch stats:\", statsData.reason)\n        setStats({ total_issues: 0, by_status: { pending: 0, in_progress: 0, resolved: 0, rejected: 0 } })\n        setStatsError(\"Unable to fetch latest stats\")\n      }\n    } catch (e: any) {\n      setError(e?.message || \"Failed to load data\")\n    } finally {\n      setStatsLoading(false)\n      isFetchingRef.current = false\n    }\n  }, [getTrustedIST])\n\n  React.useEffect(() => {\n    const run = async () => {\n      const token = typeof window !== \"undefined\" ? (localStorage.getItem(\"access_token\") || localStorage.getItem(\"token\")) : null\n      if (!token) {\n        window.location.href = \"/login\"\n        return\n      }\n      try {\n        setLoading(true)\n        await fetchData()\n      } finally {\n        setLoading(false)\n      }\n    }\n    run()\n  }, [fetchData])\n\n  // Auto-refresh: only on tab focus/visibility (no periodic polling)\n  React.useEffect(() => {\n    const handleVisibility = () => {\n      if (document.visibilityState === \"visible\") fetchData()\n    }\n    const handleFocus = () => fetchData()\n\n    document.addEventListener(\"visibilitychange\", handleVisibility)\n    window.addEventListener(\"focus\", handleFocus)\n\n    return () => {\n      document.removeEventListener(\"visibilitychange\", handleVisibility)\n      window.removeEventListener(\"focus\", handleFocus)\n    }\n  }, [fetchData])\n\n  const formatDateTime = (iso: string) => {\n    try { return new Date(iso).toLocaleString() } catch { return iso }\n  }\n\n  return (\n    <div className=\"flex flex-col min-h-screen bg-white px-6 py-12 pb-24\">\n      <h1 className=\"text-2xl font-bold mb-2\">Home  </h1>\n      <p className=\"text-sm text-gray-600 mb-6\">Real-time list of your submitted complaints</p>\n\n      {/* Success Message */}\n      {showSuccess && (\n        <div className=\"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg\">\n          <div className=\"flex items-center\">\n            <div className=\"flex-shrink-0\">\n              <svg className=\"h-5 w-5 text-green-400\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clipRule=\"evenodd\" />\n              </svg>\n            </div>\n            <div className=\"ml-3\">\n              <p className=\"text-sm font-medium text-green-800\">\n                Complaint submitted successfully! Your complaint has been registered and assigned a tracking ID.\n              </p>\n            </div>\n            <div className=\"ml-auto pl-3\">\n              <button\n                type=\"button\"\n                className=\"inline-flex rounded-md bg-green-50 p-1.5 text-green-500 hover:bg-green-100 focus:outline-none focus:ring-2 focus:ring-green-600 focus:ring-offset-2 focus:ring-offset-green-50\"\n                onClick={() => setShowSuccess(false)}\n              >\n                <span className=\"sr-only\">Dismiss</span>\n                <svg className=\"h-5 w-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                  <path d=\"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z\" />\n                </svg>\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Analytics Section */}\n      <AnalyticsSection \n        stats={stats || { total_issues: 0, by_status: { pending: 0, in_progress: 0, resolved: 0, rejected: 0 } }} \n        loading={statsLoading}\n        lastUpdatedText={lastUpdated}\n        errorText={statsError}\n      />\n\n      {loading && <p className=\"text-gray-600\">Loading...</p>}\n      {!loading && error && <p className=\"text-red-600\">{error}</p>}\n\n      {!loading && !error && (\n        <div className=\"flex flex-col gap-4\">\n          <h2 className=\"text-lg font-semibold text-gray-800\">Recent Complaints</h2>\n          {(() => {\n            const recentWithPhoto = (issues || []).filter(i => !!i.photo_url).slice(0, 5)\n            if (recentWithPhoto.length === 0) {\n              return <div className=\"text-gray-600\">No recent complaints with photos.</div>\n            }\n            return recentWithPhoto.map((issue) => (\n              <IssueCard\n                key={issue.issue_id}\n                id={String(issue.issue_id)}\n                date={formatDateTime(issue.created_at as unknown as string)}\n                status={issue.status === \"in_progress\" ? \"In Progress\" : issue.status.charAt(0).toUpperCase() + issue.status.slice(1)}\n                image={issue.photo_url as string}\n                onClick={() => router.push(`/track_issue?id=${issue.issue_id}`)}\n              />\n            ))\n          })()}\n        </div>\n      )}\n\n      <BottomNavbar />\n    </div>\n  )\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}